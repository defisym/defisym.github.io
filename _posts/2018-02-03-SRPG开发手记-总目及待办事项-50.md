---
layout: post
title: SRPG开发手记-总目及待办事项
date: 2018-02-03 22:03:38
tags: [ProjectUta,Project Ktr,该写什么标签好呢……？]

---
<span style="text-decoration:underline;">未来计划：</span>

**SRPG开发之不知道多少-卡牌指令系统**  

设计的核心，队伍槽也是为此而生的

战斗前允许组卡组，随后会为每张卡随机一个权重并存储，根据该权重排序来实现洗牌

存储该数组，在战斗界面允许抽卡时调用，抽卡，并显示出来

不同卡牌的效果实现和角色技能类似，总之是个苦力活儿

如果这套系统要做的好玩，有策略性，卡池是要足够深的，比如搞他个40张出来，每场战斗允许带10张什么的

**↓↓↓重点↓↓↓**

*   **总之，个人认为需要再找一个人专门做技能设计与关卡设计了**

*   **设计文档里面的卡牌与技能范例基本上已经是我的脑洞极限了**

*   **_(:з」∠)_**

**↑↑↑重点↑↑↑**  

**SRPG开发之不知道多少-角色技能**  

被动的根据设定在不同的系统状态之中追加判定即可

主动技能需要进入一个额外的使用阶段，并且依照着设定来继续处理

总之就是一个苦力活，不断地堆啊堆啊堆

**SRPG开发之不知道多少-物品栏与药品栏**  

一个数组维护你当前的物品，并按照某种顺序排列

呼出物品栏后依据物品ID动态显示不同的物品，点击以后进入使用流程

算了，反正道具栏打算做成通用的，也不需要给别人使用道具了……吧？

（总之都做出来就好……

与之相关的是金钱与商店系统，买买道具之类，两个数组维护，价格浮动不打算搞了，每个地区打表出来确定价格，反正战斗也不会难道那种地步，灵活运用系统基本上可以无伤的

**SRPG开发之不知道多少-物品的合成与料理的制作**

以前尝试过，但是操作是个大问题，鼠标拖拽的吸附怎么都做不好

于是就放弃了，改成点击格子再点击材料的形式

其实是在背回旋锅期间研究出来的，不过那口锅碎了

总之每个道具（包括空格子）都会有一个唯一的ID，而放置之后会根据格子的顺序来生成一个字符串

比如空格子是###，材料A是IXY，B是SBX，九宫格上三个都是A，中间左右是B中间留空，下三个都是A，那么生成的公式就是IXYIXYIXYSBX###SBXIXYIXYIXY，如果需要严格判定位置的话，就需要逐个字符比对（用于道具），符合条件的会返回一个物品ID，响应道具-1，新增物品+1

而对位置没有要求的，就查找对应字符串即可，例如含有IXY的都可以完全恢复，含有SBX的都可以抵抗寒冷，云云，当然这个查找是有优先级的，某个效果会掩盖其他效果或者不同效果之间混合导致没有效果等等

<span style="text-decoration:underline;">历史日志：</span>

**2018.01.31：[SRPG开发之六-天气与地形互动](http://defisym.lofter.com/post/1eaddb63_122531c1)**

完全没动的草地点火会是个麻烦事儿，循环起来开销肯定小不了，每回合做一次……

你每回合循环的东西已经不少了，还来！

另外一个问题就是风向，风的互动也在考虑之中，如果东风火还朝着西边烧就太尴尬了

<span style="text-decoration:line-through;">（实现不了的统统删掉！</span><span style="text-decoration:line-through;">（</span><span style="text-decoration:line-through;">←逃避问题）</span>

**2017.12.31：[SRPG开发之五点五-远程敌人AI](http://defisym.lofter.com/post/1eaddb63_11f2c818)**  

视频演示

和近战一样的弱智，除了弱智没啥太大的问题

原本是想着有遮挡打不中的，然后出了bug，可以隔山打牛……

——“我要在你身前，守护你！”

——“放弃吧，你背后的角色被选为攻击目标时别的单位是没有判定的”

**2017.10.14：[SRPG开发之五-敌人AI](http://defisym.lofter.com/post/1eaddb63_11610292)**

近战敌人AI，除了比较弱智之外没什么太大的问题

·应该将数组之中的距离权重计算方式从坐标距离改成寻路步数，不过地图不是非常复杂的话这两者差异并不大

·角色仇恨没有太好的想法，每个敌人一个独立数组开销太大，也不方便维护，现在想的是受到伤害之后记录攻击对象ID，在下一次行动时为该ID对应的角色增加权重

<span style="text-decoration:line-through;">（所以两个远程单位就可以遛死你了</span>

·捡着弱角色揍，只要加上HP、防御力的权重就行了

至于判断局势，作出预判操作……没那个技术实力，<span style="text-decoration:line-through;">我又不是学CS的</span>（←逃避问题

**2017.10.08：[SRPG开发之四](http://defisym.lofter.com/post/1eaddb63_11549504)**

行动序列的处理

老实说现在的行动序列还是直接取数组前六个，但这样其实是不对的

仔细观察就会发现角色行动顺序并没有严格按照该队列

问题是这样出现的：

假设行动条上限20，满了以后就会允许行动，角色A速度6，当前14，角色B速度3，当前16，那么行动序列会显示角色B先行动

但是在当前角色行动之后，行动序列会进行更新，此时角色A的行动条为20，B为19，反而是A先行动

正确的做法……老实说我也不太清楚，总之应该是循环计算，维护一个队列

另外将行动条的上限增大也可以一定程度上解决这个问题（个人倾向于后者

其实不管应该也可以，你看打传颂原作在战略视图才能看行动序列，通关了我也没看过几次（←逃避现实

**<span style="text-decoration:line-through;">2017.02~2017.10</span>**

<span style="text-decoration:line-through;">中间发生了很多事情！</span>

<span style="text-decoration:line-through;">一开始啥也不知道的时候很开心！！</span>

<span style="text-decoration:line-through;">知道真相了以后很憋气！！！</span>

<span style="text-decoration:line-through;">啊！要是没这口回旋锅这个坑估计都填完了啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊！！！！</span>

<span style="text-decoration:line-through;">其实我一直都在怨念，嗯，我就是一死板的小心眼子，一根筋的人形自走醋坛子</span>

**2017.02.10：[SRPG开发之三](http://defisym.lofter.com/post/1eaddb63_e2be585)**

做了些优化，反正哪个版本基本上是不可玩的

后来10月份重构了一次，现在的工作都是基于新版的

**2017.02.09：[SRPG开发之二](http://defisym.lofter.com/post/1eaddb63_e275143)  
**

移动范围的计算吧好像……没有数组维护拿坐标硬算DFS真是一件happy的事情

**2017.02.08：[SRPG开发之一](http://defisym.lofter.com/post/1eaddb63_e231573)**  

我记得是做了寻路的碰撞检测